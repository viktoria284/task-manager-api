# Task Manager REST API

Лабораторная работа **«Проектирование и реализация REST API»**.

Цель работы: Закрепить принципы проектирования REST API: простота, стабильность, версионность, идемпотентность, ограничение частоты запросов и документация.

## 1. Предметная область

Предметная область — **система управления задачами**.

### Сущности и связи

**User** (пользователь):

- `id` — идентификатор;
- `email` — логин, уникальный;
- `password_hash` — хэш пароля;
- `full_name` — ФИО;
- `created_at` — дата регистрации.

**Task** (задача):

- `id` — идентификатор задачи;
- `owner_id` — внешний ключ на `users.id`;
- `title` — короткий заголовок;
- `description` — описание;
- `status` — состояние задачи: `todo | in_progress | done`;
- `priority` — приоритет задачи (в v2 API): `low | medium | high`;
- `due_date` — срок выполнения (опционально);
- `created_at`, `updated_at` — даты создания и последнего обновления.

**Связь:** один пользователь может иметь много задач (связь 1:N).

Реализация: `app/db/models.py` (модели SQLAlchemy `UserDB` и `TaskDB`).

---

## 2. Версионность API и ресурсы

В проекте реализованы две версии API:

- **`/api/v1`** — базовая версия.
- **`/api/v2`** — расширенная версия.

Реализация:

- `app/api/v1/__init__.py` — роутер `/api/v1`.
- `app/api/v2/__init__.py` — роутер `/api/v2`.
- `app/main.py` — подключение обеих версий к приложению FastAPI.

### Ресурсы

- `auth` — регистрация и аутентификация (`/api/v1/auth/...`).
- `tasks` — управление задачами (`/api/v1/tasks`, `/api/v2/tasks`).

---

## 3. Аутентификация (JWT)

Выбран способ аутентификации: **JWT (JSON Web Token)** со схемой `Bearer`.

Причины выбора:

- **Stateless**: сервер не хранит сессии, достаточно секретного ключа.
- **Удобно для REST**: токен передаётся в заголовке `Authorization`.
- **Расширяемость**: легко использовать в распределённых системах и микросервисах.

Реализация:

- `app/core/config.py` — настройки `SECRET_KEY`, `ALGORITHM`, `ACCESS_TOKEN_EXPIRE_MINUTES`.
- `app/api/deps.py`:
  - `hash_password`, `verify_password` — хэширование пароля (passlib + bcrypt);
  - `create_access_token` — создание JWT;
  - `get_current_user` — декодирование JWT и получение пользователя.
- `app/api/v1/endpoints/auth.py`:
  - `POST /api/v1/auth/register` — регистрация пользователя;
  - `POST /api/v1/auth/login` — логин, возвращает `Token { access_token, token_type }`.

При обращении к защищённым эндпоинтам требуется заголовок:

```http
Authorization: Bearer <JWT>
